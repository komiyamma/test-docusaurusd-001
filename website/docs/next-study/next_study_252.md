# ç¬¬252ç« ï¼šCI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®å½¹å‰²ï¼ˆGitHub Actionsç­‰ï¼‰ğŸ¤–

### ä»Šæ—¥ã®ã‚´ãƒ¼ãƒ«ğŸ¯

ã“ã®ç« ãŒçµ‚ã‚ã‚‹ã¨â€¦

* CI / CD ãŒã€Œä½•ã®ãŸã‚ã«ã‚ã‚‹ã®ã‹ã€ãŒã‚¹ãƒƒã‚­ãƒªã‚ã‹ã‚‹âœ¨
* Next.jsãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«**æœ€å°ã®CIï¼ˆè‡ªå‹•ãƒã‚§ãƒƒã‚¯ï¼‰**ã‚’å…¥ã‚Œã‚‰ã‚Œã‚‹âœ…
* ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆCDï¼‰ã¯ã©ã†è€ƒãˆã‚‹ï¼Ÿã€ã®åŸºæœ¬ã‚‚ã¤ã‹ã‚ã‚‹ğŸš€

---

## 1) CI/CDã£ã¦çµå±€ãªã«ï¼ŸğŸ™

**CIï¼ˆç¶™ç¶šçš„ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰**ï¼šã‚³ãƒ¼ãƒ‰ã‚’GitHubã«ä¸Šã’ãŸã‚‰ã€**è‡ªå‹•ã§ãƒã‚§ãƒƒã‚¯ï¼ˆlint / ãƒ†ã‚¹ãƒˆ / ãƒ“ãƒ«ãƒ‰ï¼‰**ã—ã¦å£Šã‚Œã¦ãªã„ã‹ç¢ºèªã™ã‚‹ä»•çµ„ã¿âœ…
**CDï¼ˆç¶™ç¶šçš„ãƒ‡ãƒªãƒãƒªãƒ¼/ãƒ‡ãƒ—ãƒ­ã‚¤ï¼‰**ï¼šãƒã‚§ãƒƒã‚¯ã‚’é€šã£ãŸã‚‰ã€**æœ¬ç•ªã‚„æ¤œè¨¼ç’°å¢ƒã«å‡ºã™ã¨ã“ã‚ã¾ã§**ã‚’è‡ªå‹•åŒ–ã™ã‚‹è€ƒãˆæ–¹ğŸš€

GitHub Actions ã¯ã€ã“ã®CI/CDã‚’è‡ªå‹•åŒ–ã§ãã‚‹ä»•çµ„ã¿ã ã‚ˆã€œğŸ¤–âœ¨ ([GitHub Docs][1])
ã€ŒCDã€ã£ã¦è¨€ã£ã¦ã‚‚ **â€œè‡ªå‹•ã§æœ¬ç•ªã«å‡ºã™â€**ï¼ˆDeploymentï¼‰ã¾ã§ã‚„ã‚‹å ´åˆã¨ã€**â€œå‡ºã›ã‚‹çŠ¶æ…‹ã«ã™ã‚‹â€**ï¼ˆDeliveryï¼‰ã¾ã§ã®å ´åˆãŒã‚ã‚‹ã‚ˆã€œğŸ§  ([GitHub][2])

---

## 2) ãªã‚“ã§å¿…è¦ãªã®ï¼Ÿï¼ˆ3ã¤ã ã‘è¦šãˆã‚ˆï¼‰ğŸ«¶

1. **å£Šã‚ŒãŸã¾ã¾ main ã«å…¥ã‚‹ã®ã‚’é˜²ã**ğŸ›¡ï¸
2. **â€œç§ã®PCã§ã¯å‹•ãã®ã«â€¦â€å•é¡Œã‚’æ¸›ã‚‰ã™**ğŸ˜‡
3. **ãƒãƒ¼ãƒ ã§ã‚‚1äººé–‹ç™ºã§ã‚‚å®‰å¿ƒã—ã¦é€²ã‚ã‚‰ã‚Œã‚‹**ï¼ˆæœªæ¥ã®è‡ªåˆ†ãŒåŠ©ã‹ã‚‹ï¼‰ğŸ’–

---

## 3) GitHub Actionsã®åŸºæœ¬ãƒ‘ãƒ¼ãƒ„ğŸ§©

* **Workflowï¼ˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼‰**ï¼šè‡ªå‹•åŒ–ã®ãƒ¬ã‚·ãƒ”å…¨ä½“ğŸ³ï¼ˆä¾‹ï¼šCIï¼‰
* **Jobï¼ˆã‚¸ãƒ§ãƒ–ï¼‰**ï¼šä¸¦åˆ—/é †ç•ªã§å‹•ãã¾ã¨ã¾ã‚ŠğŸ§±ï¼ˆä¾‹ï¼šbuild jobï¼‰
* **Stepï¼ˆã‚¹ãƒ†ãƒƒãƒ—ï¼‰**ï¼š1å€‹ãšã¤ã®ä½œæ¥­ğŸ§¹ï¼ˆä¾‹ï¼šnpm ciï¼‰

---

## 4) Next.jsã§ã€Œæœ€ä½é™ã‚„ã‚‹CIã€ã‚»ãƒƒãƒˆâœ…âœ¨

Next.jsï¼ˆ2025ã®æœ€æ–°æƒ³å®šï¼‰ã ã¨ã€ã¾ãšã¯ã“ã‚ŒãŒé‰„æ¿ğŸ’ª

* ä¾å­˜é–¢ä¿‚ã‚’å…¥ã‚Œã‚‹ï¼š`npm ci` ğŸ“¦
* Lintï¼š`npm run lint` ğŸ§¹
* ãƒ†ã‚¹ãƒˆï¼š`npm test`ï¼ˆã‚ã‚‹ãªã‚‰ï¼‰ğŸ§ª
* ãƒ“ãƒ«ãƒ‰ï¼š`npm run build` ğŸ—ï¸

ã‚ã¨å¤§äº‹ãªã®ãŒ **Node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³**ï¼
Next.jsã¯æœ€ä½ Node.js **20.9ä»¥ä¸Š**ãŒå¿…è¦ã ã‚ˆğŸ§  ([Next.js][3])

---

## 5) å›³ã§ã¤ã‹ã‚€ï¼šPRãŒå‡ºãŸã¨ãã®æµã‚ŒğŸ§ â¡ï¸âœ…

```mermaid
flowchart LR
  A["é–‹ç™ºè€…ãŒpush/PRä½œæˆğŸ§‘â€ğŸ’»"] --> B["GitHub Actionsèµ·å‹•ğŸ¤–"]
  B --> C["ä¾å­˜é–¢ä¿‚installğŸ“¦"]
  C --> D["LintğŸ§¹"]
  D --> E["ãƒ†ã‚¹ãƒˆğŸ§ª"]
  E --> F["ãƒ“ãƒ«ãƒ‰ğŸ—ï¸"]
  F --> G{"å…¨éƒ¨OKï¼Ÿ"}
  G -->|"Yes"| H["PRã«âœ…ãŒä»˜ã"]
  G -->|"No"| I["âŒãƒ­ã‚°ã‚’è¦‹ã¦ä¿®æ­£"]
```

![CI ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®æµã‚Œ](./picture/next_study_252_ci_cd.png)

---

## 6) ãƒãƒ³ã‚ºã‚ªãƒ³ï¼šCIã‚’1æœ¬å…¥ã‚Œã¦ã¿ã‚ˆã†ï¼ˆWindowsï¼‰ğŸ› ï¸ğŸ’–

### æ‰‹é †â‘ ï¼šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹ğŸ“

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç›´ä¸‹ã«ã“ã‚Œã‚’ä½œã‚‹ã‚ˆğŸ‘‡
`.github/workflows/ci.yml`

### æ‰‹é †â‘¡ï¼šä¸­èº«ã‚’ã‚³ãƒ”ãƒšï¼ˆæœ€å°CIï¼‰âœ‚ï¸âœ¨

```yaml
name: CI

on:
  pull_request:
  push:
    branches: [main]

concurrency:
  group: ci-${{ github.ref }}
  cancel-in-progress: true

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "20"
          cache: "npm"

      - name: Install dependencies
        run: npm ci

      - name: Lint
        run: npm run lint

      - name: Test (if present)
        run: npm test --if-present

      - name: Build
        run: npm run build
```

### æ‰‹é †â‘¢ï¼šã‚³ãƒŸãƒƒãƒˆã—ã¦pushã™ã‚‹ğŸ§¡

PowerShellã®ä¾‹ã ã‚ˆğŸ‘‡

```bash
git add .github/workflows/ci.yml
git commit -m "Add CI workflow"
git push
```

ã™ã‚‹ã¨ã€GitHubã® **Actionsã‚¿ãƒ–**ã§å‹•ã„ã¦ã€PRã«ã‚‚âœ…/âŒãŒä»˜ãã‚ˆã€œï¼ğŸ‰

---

## 7) è¶…é‡è¦ï¼šlintã‚³ãƒãƒ³ãƒ‰äº‹æƒ…ï¼ˆ2025ï¼‰âš ï¸ğŸ§¹

æœ€è¿‘ã®Next.jsã§ã¯ã€`next lint` ãŒæ•´ç†ã•ã‚Œã¦ã„ã¦ã€

* Next.js 15.5 ã§ `next lint` ã¯éæ¨å¥¨ã«ãªã‚Šã€**eslint/biome ã‚’ç›´æ¥å‘¼ã¶æ–¹é‡**ã«ç§»è¡ŒğŸƒâ€â™€ï¸ ([Next.js][4])
* Next.js 16 ã§ã¯ `next lint` ãŒå‰Šé™¤ã•ã‚Œã¦ã€**eslint/biome ã‚’ç›´æ¥ä½¿ã†**ã®ãŒå‰æã«ãªã£ãŸã‚ˆğŸ§  ([Next.js][5])

ã ã‹ã‚‰CIã¯ **`npm run lint`** ã«ã—ã¦ãŠãã®ãŒå®‰å…¨ğŸ™†â€â™€ï¸ï¼ˆä¸­èº«ãŒ eslint ã§ã‚‚ biome ã§ã‚‚OKï¼‰

---

## 8) å¤±æ•—ã—ãŸã¨ãã®è¦‹æ–¹ğŸ‘€ğŸ”

Actionsã§âŒã«ãªã£ãŸã‚‰ã€ã¾ãšã“ã“ã ã‘è¦‹ã‚Œã°OKï¼

* **ã©ã®Stepã§è½ã¡ãŸï¼Ÿ**ï¼ˆLint / Test / Buildï¼‰
* **ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æœ€åˆã®1ã€œ3è¡Œ**ï¼ˆåŸå› ãŒå‡ºã‚„ã™ã„ï¼‰
* **ãƒ­ãƒ¼ã‚«ãƒ«ã§åŒã˜ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ**ã—ã¦å†ç¾ã™ã‚‹

  * `npm run lint`
  * `npm run build`

---

## 9) CDï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤ï¼‰ã¯ã©ã†ã™ã‚‹ï¼Ÿ2ã¤ã®è€ƒãˆæ–¹ğŸš€âœ¨

### â‘  ã„ã¡ã°ã‚“ãƒ©ã‚¯ï¼šVercelã®Gité€£æºã«ä»»ã›ã‚‹ğŸŒˆ

GitHubã«ç¹‹ãã ã‘ã§

* PRã”ã¨ã« **Preview URL** ãŒè‡ªå‹•ã§ã§ãã‚‹
* main ã«ãƒãƒ¼ã‚¸ã—ãŸã‚‰ **æœ¬ç•ªã¸è‡ªå‹•åæ˜ **
  ã¿ãŸã„ãªä½“é¨“ãŒã§ãã‚‹ã‚ˆğŸ“¦ğŸš€ ([Vercel][6])

ã“ã®å ´åˆã®ãŠã™ã™ã‚ã¯ğŸ‘‡

* **GitHub Actionsï¼šCIï¼ˆãƒ†ã‚¹ãƒˆãƒ»ãƒ“ãƒ«ãƒ‰ã®å“è³ªãƒã‚§ãƒƒã‚¯ï¼‰**
* **Vercelï¼šãƒ‡ãƒ—ãƒ­ã‚¤æ‹…å½“**
  ã£ã¦åˆ†ã‘ã‚‹ã‚„ã‚Šæ–¹ğŸ«¶

### â‘¡ Actionsã§ãƒ‡ãƒ—ãƒ­ã‚¤ã¾ã§ã‚„ã‚‹ï¼ˆã¡ã‚‡ã„ä¸Šç´šï¼‰ğŸ¤–ğŸ”¥

ã€Œæœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ã‚‚Actionsã§ç®¡ç†ã—ãŸã„ã€ãªã‚‰
Secretsï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ï¼‰ã‚’ä½¿ã£ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹å½¢ã«ãªã‚‹ã‚ˆğŸ”
â€»Secretsã®æ‰±ã„ã¯ã‚ã¡ã‚ƒå¤§äº‹ï¼ˆæ¼ã‚ŒãŸã‚‰äº‹æ•…ğŸ˜±ï¼‰

---

## 10) ãƒŸãƒ‹èª²é¡ŒğŸ“âœ¨ï¼ˆã§ããŸã‚‰å¼·ã„ï¼‰

1. `npm run typecheck` ã‚’è¿½åŠ ã—ã¦ã¿ã‚ˆğŸ§ ï¼ˆTSãªã‚‰è¶…å®‰å¿ƒï¼‰
2. main ãƒ–ãƒ©ãƒ³ãƒã«ã€ŒCIãŒé€šã‚‰ãªã„ã¨ãƒãƒ¼ã‚¸ã§ããªã„ã€ãƒ«ãƒ¼ãƒ«ã‚’ä»˜ã‘ã¦ã¿ã‚ˆğŸ›¡ï¸
   ï¼ˆGitHubã®Branch protectionã§è¨­å®šã§ãã‚‹ã‚ˆã€œï¼‰

---

## ã¾ã¨ã‚ğŸ’

* **CI**ã¯ã€Œå£Šã—ã¦ãªã„ã‹è‡ªå‹•ã§ç¢ºèªã™ã‚‹ä¿é™ºã€ğŸ›¡ï¸
* **CD**ã¯ã€Œå‡ºã™ã¨ã“ã‚ã¾ã§ã‚’ä»•çµ„ã¿åŒ–ã™ã‚‹ã€ğŸš€
* Next.jsã¯ã¾ãš **Install â†’ Lint â†’ Test â†’ Build** ã®CIã§OKâœ…
* 2025ç’°å¢ƒã§ã¯ **Node 20.9+** ã‚’æ„è­˜ã—ã¦ã­âœ¨ ([Next.js][3])

æ¬¡ç« ï¼ˆç¬¬253ç« ï¼‰ã§ã€ŒVercelä»¥å¤–ã®ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆDocker/Self-hostingï¼‰ã€ã«å…¥ã‚‹ã¨ã€ã“ã“ã§ä½œã£ãŸCIãŒã•ã‚‰ã«åŠ¹ã„ã¦ãã‚‹ã‚ˆã€œï¼ğŸ³ğŸ’ª

[1]: https://docs.github.com/articles/getting-started-with-github-actions?utm_source=chatgpt.com "Understanding GitHub Actions"
[2]: https://github.com/resources/articles/ci-cd?utm_source=chatgpt.com "What is CI/CD?"
[3]: https://nextjs.org/docs/app/getting-started/installation?utm_source=chatgpt.com "Getting Started: Installation"
[4]: https://nextjs.org/blog/next-15-5 "Next.js 15.5 | Next.js"
[5]: https://nextjs.org/blog/next-16 "Next.js 16 | Next.js"
[6]: https://vercel.com/docs/git/vercel-for-github?utm_source=chatgpt.com "Deploying GitHub Projects with Vercel"
