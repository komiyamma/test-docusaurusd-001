# ç¬¬209ç« ï¼šç·´ç¿’ï¼šãƒœã‚¿ãƒ³æŠ¼ã—ãŸã‚‰å¢—ãˆã‚‹ãƒ†ã‚¹ãƒˆâ•

ä»Šæ—¥ã¯ã€Œ**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã‚‰æ•°å­—ãŒå¢—ãˆã‚‹**ã€ã£ã¦ã„ã†ã€ã„ã¡ã°ã‚“ç‹é“ã®UIãƒ†ã‚¹ãƒˆã‚’ã‚„ã£ã¦ã¿ã‚‹ã‚ˆã€œï¼ğŸ˜†ğŸ«¶
ï¼ˆã“ã®ç« ã®ã‚´ãƒ¼ãƒ«ã¯â€œæ›¸ã‘ãŸï¼†å‹•ã„ãŸâ€ã®é”æˆæ„Ÿã§ã™ğŸ‰ï¼‰

---

## ä»Šæ—¥ã®ã‚´ãƒ¼ãƒ« ğŸ¯ğŸ’–

* âœ… `Counter` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œã‚‹ğŸ§®
* âœ… ãƒ†ã‚¹ãƒˆã§ã€Œã‚¯ãƒªãƒƒã‚¯ã—ãŸã‚‰ 0â†’1â†’2ã€ã«ãªã‚‹ã®ã‚’ç¢ºèªã™ã‚‹ğŸ–±ï¸â•
* âœ… **UIã‚’è§¦ã‚‹ãƒ†ã‚¹ãƒˆã®åŸºæœ¬å½¢**ã‚’ä½“ã«æŸ“ã¿è¾¼ã¾ã›ã‚‹ğŸ’ªâœ¨

---

## ãƒ†ã‚¹ãƒˆã®æµã‚Œï¼ˆå›³è§£ï¼‰ğŸ—ºï¸âœ¨

![counter test](./picture/next_study_209_counter_test.png)

```mermaid
flowchart LR
  A["ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’renderã™ã‚‹ğŸ–¼ï¸"] --> B["åˆæœŸè¡¨ç¤ºã‚’ç¢ºèªã™ã‚‹ğŸ‘€"]
  B --> C["ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ğŸ–±ï¸"]
  C --> D["è¡¨ç¤ºãŒ1ã¤å¢—ãˆãŸã‹ç¢ºèªã™ã‚‹âœ…"]
  D --> E["ã‚‚ã†ä¸€å›ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ğŸ–±ï¸"]
  E --> F["ã•ã‚‰ã«å¢—ãˆãŸã‹ç¢ºèªã™ã‚‹âœ…"]
```

---

## â‘  Counterã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œã‚‹ ğŸ§®ğŸŒ¸

å¥½ããªå ´æ‰€ã« `Counter.tsx` ã‚’ä½œã£ã¦ã­ï¼ˆä¾‹ï¼š`src/components/Counter.tsx`ï¼‰ğŸ“âœ¨
â€»ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã®ã§ **`"use client"` ãŒå¿…è¦**ã ã‚ˆã€œï¼ğŸ®

```tsx
"use client";

import { useState } from "react";

export function Counter() {
  const [count, setCount] = useState(0);

  return (
    <div>
      <p>
        ã„ã¾ã®æ•°ï¼š<span aria-label="count">{count}</span>
      </p>

      <button type="button" onClick={() => setCount((c) => c + 1)}>
        å¢—ã‚„ã™
      </button>
    </div>
  );
}
```

ãƒã‚¤ãƒ³ãƒˆğŸ’¡

* `aria-label="count"` ã‚’ä»˜ã‘ã‚‹ã¨ã€ãƒ†ã‚¹ãƒˆã§ **ã€Œcountã£ã¦åå‰ã®è¡¨ç¤ºã€**ã¨ã—ã¦å–ã‚Šã‚„ã™ã„ã‚ˆğŸ˜ŠğŸ«¶
* ãƒœã‚¿ãƒ³ã¯ `type="button"` ã‚’ä»˜ã‘ã¦ãŠãã¨ã€ãƒ•ã‚©ãƒ¼ãƒ ã®ä¸­ã§ã‚‚äº‹æ•…ã‚Šã«ãã„ğŸ‘âœ¨

---

## â‘¡ ãƒ†ã‚¹ãƒˆã‚’æ›¸ã ğŸ§ªğŸ–Šï¸âœ¨

ä¾‹ãˆã° `src/components/__tests__/Counter.test.tsx` ã‚’ä½œã£ã¦ã­ğŸ“ğŸ§¸
ï¼ˆ`__tests__` ã¯å¥½ã¿ï¼åŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã« `Counter.test.tsx` ã§ã‚‚OKã ã‚ˆã€œğŸ™†â€â™€ï¸ï¼‰

```tsx
import { render, screen } from "@testing-library/react";
import userEvent from "@testing-library/user-event";
import { describe, it, expect } from "vitest";
import { Counter } from "../Counter";

describe("Counter", () => {
  it("ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨æ•°ãŒå¢—ãˆã‚‹", async () => {
    const user = userEvent.setup();

    render(<Counter />);

    const count = screen.getByLabelText("count");
    const button = screen.getByRole("button", { name: "å¢—ã‚„ã™" });

    expect(count.textContent).toBe("0");

    await user.click(button);
    expect(count.textContent).toBe("1");

    await user.click(button);
    expect(count.textContent).toBe("2");
  });
});
```

ã“ã“ãŒè¶…å¤§äº‹ãƒã‚¤ãƒ³ãƒˆğŸ’–

* `userEvent` ã¯ **await ä»˜ã**ã§ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã®ãŒåŸºæœ¬ã ã‚ˆã€œï¼ğŸ–±ï¸â³
* `screen.getByRole("button", { name: "å¢—ã‚„ã™" })` ã¯ã€å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€Œãƒœã‚¿ãƒ³ã‚’æ¢ã™ã€æ„Ÿè¦šã«è¿‘ã„ã®ã§ãŠã™ã™ã‚ğŸ˜Šâœ¨

---

## â‘¢ ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ â–¶ï¸ğŸ§ªğŸš€

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã‚ˆã£ã¦ã‚³ãƒãƒ³ãƒ‰ã¯é•ã†ã‘ã©ã€ã ã„ãŸã„ã“ã®ã¸ã‚“ğŸ‘‡âœ¨

```bash
npm run test
```

ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒç„¡ã„å ´åˆã¯ğŸ‘‡

```bash
npx vitest
```

---

## â‘£ ã¤ã¾ãšãã‚„ã™ã„æ‰€ï¼ˆå‡ºãŸã‚‰ã“ã“è¦‹ã¦ğŸ¥ºğŸ§¯ï¼‰

### ğŸ§Š `document is not defined` ãŒå‡ºãŸï¼

â†’ ãƒ†ã‚¹ãƒˆç’°å¢ƒãŒ `jsdom` ã«ãªã£ã¦ãªã„å¯èƒ½æ€§ãŒé«˜ã„ã‚ˆã€œï¼

`vitest.config.ts`ï¼ˆãªã‘ã‚Œã°ä½œæˆï¼‰ã«ã“ã†ã„ã†è¨­å®šã‚’å…¥ã‚Œã¦ã­ğŸ‘‡

```ts
import { defineConfig } from "vitest/config";

export default defineConfig({
  test: {
    environment: "jsdom",
  },
});
```

### ğŸŒ€ `TestingLibraryElementError: Unable to find...` ãŒå‡ºãŸï¼

â†’ ã ã„ãŸã„ã“ã®ã©ã‚Œã‹ï¼ğŸ¥¹

* `aria-label="count"` ã®ã‚¹ãƒšãƒ«é•ã„
* ãƒœã‚¿ãƒ³ã®æ–‡å­—ãŒ `å¢—ã‚„ã™` ã˜ã‚ƒãªããªã£ã¦ã‚‹
* import ã®ãƒ‘ã‚¹ãŒé•ã†ï¼ˆ`../Counter` ãŒåˆã£ã¦ã‚‹ã‹ç¢ºèªï¼‰ğŸ”

---

## â‘¤ ãƒŸãƒ‹ãƒãƒ£ãƒ¬ãƒ³ã‚¸ï¼ˆä½™è£•ãŒã‚ã£ãŸã‚‰ï¼‰ğŸŒŸğŸ˜†

1. **ã€Œæ¸›ã‚‰ã™ã€ãƒœã‚¿ãƒ³**ã‚‚è¿½åŠ ã—ã¦ã€ãƒ†ã‚¹ãƒˆã‚‚è¶³ã—ã¦ã¿ã‚ˆâ–ğŸ§ª
2. ã‚¯ãƒªãƒƒã‚¯1å›ã§ **+5** ã™ã‚‹ãƒœã‚¿ãƒ³ã‚’è¿½åŠ ã—ã¦ã¿ã‚ˆâ•â•â•â•â•âœ¨
3. åˆæœŸå€¤ã‚’ props ã§å—ã‘å–ã‚Œã‚‹ã‚ˆã†ã«ã—ã¦ã€ãƒ†ã‚¹ãƒˆã§åˆæœŸå€¤ãƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã‚ˆğŸ

---

ã§ããŸã‚‰ã‚‚ã†ã€UIãƒ†ã‚¹ãƒˆã®åŸºæœ¬å½¢ã¯ãƒãƒƒãƒãƒªã ã‚ˆã€œï¼ğŸ‰ğŸ«¶âœ¨
