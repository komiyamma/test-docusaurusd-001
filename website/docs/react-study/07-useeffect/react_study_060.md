# ç¬¬60ç« ï¼šè¦‹å¼µã‚Šãƒªã‚¹ãƒˆ `[state]`

ã“ã®ç« ã§ã¯ã€`useEffect` ã®ã€Œè¦‹å¼µã‚Šãƒªã‚¹ãƒˆã€ã« **`[state]` ã‚’å…¥ã‚ŒãŸã¨ãã®å‹•ã** ã‚’ã—ã£ã‹ã‚Šç†è§£ã—ã¦ã„ãã¾ã™ âœ¨

> ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯
> **ã€Œã“ã®å€¤ãŒå¤‰ã‚ã£ãŸã¨ãã ã‘ã€`useEffect` ã‚’å‹•ã‹ã™ã€** ã§ã™ âœ…

---

### 1ï¸âƒ£ ãŠã•ã‚‰ã„ï¼š`useEffect` ã®åŸºæœ¬ã‚¤ãƒ¡ãƒ¼ã‚¸ ğŸ§ 

`useEffect` ã¯ã€ã–ã£ãã‚Šè¨€ã†ã¨ã“ã‚“ãªå­ã§ã—ãŸï¼š

* ã€Œç”»é¢ã®è¦‹ãŸç›®ã€ä»¥å¤–ã®ä»•äº‹ã‚’ã™ã‚‹å­ï¼ˆï¼**å‰¯ä½œç”¨**ï¼‰

  * ä¾‹ï¼šã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ­ã‚°ã‚’å‡ºã™ã€`document.title` ã‚’å¤‰ãˆã‚‹ã€ã‚¿ã‚¤ãƒãƒ¼ã‚’å‹•ã‹ã™ ãªã©
* æ›¸ãæ–¹ã¯ã“ã‚“ãªæ„Ÿã˜ï¼š

```tsx
useEffect(() => {
  // ã“ã“ã«ã€Œå‰¯ä½œç”¨ã€ã®å‡¦ç†ã‚’æ›¸ã
}, /* â† ã“ã“ãŒã€è¦‹å¼µã‚Šãƒªã‚¹ãƒˆã€ */);
```

ã“ã® **ç¬¬2å¼•æ•°** ã«å…¥ã‚‹é…åˆ—ãŒã€Œè¦‹å¼µã‚Šãƒªã‚¹ãƒˆï¼ˆä¾å­˜é…åˆ—ï¼‰ã€ã§ã™ã€‚
React ã¯ã“ã“ã«å…¥ã£ã¦ã„ã‚‹å€¤ã‚’å‰å›ã¨æ¯”ã¹ã¦ã€å¤‰ã‚ã£ã¦ã„ãŸã‚‰ã‚‚ã†ä¸€åº¦ `useEffect` ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚([react.dev][1])

---

### 2ï¸âƒ£ è¦‹å¼µã‚Šãƒªã‚¹ãƒˆã®3ãƒ‘ã‚¿ãƒ¼ãƒ³ã–ã£ãã‚Šæ¯”è¼ƒ ğŸ‘€

ã¾ãšã¯å…¨ä½“åƒã‚’ã•ã‚‰ã£ã¨æ•´ç†ã—ã¡ã‚ƒã„ã¾ã—ã‚‡ã†ï¼š

* `[]`
  â†’ æœ€åˆã®1å›ã ã‘ï¼ˆãƒã‚¦ãƒ³ãƒˆæ™‚ã ã‘ï¼‰å®Ÿè¡Œ
* `[state]`
  â†’ **`state` ãŒå¤‰ã‚ã£ãŸã¨ãã ã‘** å®Ÿè¡Œ â† ä»Šæ—¥ã¯ã“ã“â€¼ï¸
* ï¼ˆç¬¬2å¼•æ•°ãªã—ï¼‰
  â†’ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒãƒ¬ãƒ³ãƒ€ãƒ¼ã•ã‚Œã‚‹ãŸã³æ¯å›å®Ÿè¡Œï¼ˆã»ã¨ã‚“ã©ä½¿ã‚ãªã„ï¼‰

ä»Šå›ã®ä¸»å½¹ã¯ **`[state]`** ã§ã™ ğŸ‰

---

### 3ï¸âƒ£ å›³ã§ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š`[count]` ãŒå¤‰ã‚ã£ãŸã¨ãã ã‘å‹•ã ğŸŒˆ

ã€Œãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ `count` ãŒå¤‰ã‚ã£ãŸã¨ãã ã‘ `useEffect` ãŒèµ°ã‚‹ã€ã¨ã„ã†æµã‚Œã‚’ Mermaid ã§å›³è§£ã—ã¦ã¿ã¾ã™ ğŸ§©

```mermaid
flowchart TD
  A[ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€Œï¼‹ãƒœã‚¿ãƒ³ã€ã‚’ã‚¯ãƒªãƒƒã‚¯] --> B[setCount ã§ count ã‚’æ›´æ–°]
  B --> C[App ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå†ãƒ¬ãƒ³ãƒ€ãƒ¼]
  C --> D{å‰å›ã® count ã¨é•ã†ï¼Ÿ}
  D -- YES âœ E[useEffect ãŒå®Ÿè¡Œã•ã‚Œã‚‹]
  D -- NO âœ F[useEffect ã¯ã‚¹ã‚­ãƒƒãƒ—]
```

ã“ã‚“ãªæ„Ÿã˜ã§ã€React ã¯

> ã€Œ**è¦‹å¼µã‚Šãƒªã‚¹ãƒˆã«å…¥ã£ã¦ã„ã‚‹å€¤ãŒå¤‰ã‚ã£ãŸã‹ã©ã†ã‹**ã€
> ã‚’æ¯å›ãƒã‚§ãƒƒã‚¯ã—ã¦ãã‚Œã¦ã„ã¾ã™ âœ…

---

### 4ï¸âƒ£ å®Ÿé¨“â‘ ï¼šã‚«ã‚¦ãƒ³ãƒˆãŒå¤‰ã‚ã£ãŸã¨ãã ã‘ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ­ã‚°ã‚’å‡ºã™ ğŸ§ªâœ¨

ã§ã¯ã€å®Ÿéš›ã«ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã€Œ`[count]` ã®ã¨ãã ã‘å‹•ãã€æ„Ÿè¦šã‚’ã¤ã‹ã¿ã¾ã—ã‚‡ã† ğŸ’»

#### ğŸ›  æ‰‹é †

1. Vite ã§ä½œã£ãŸ React + TS ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ã
2. `src/App.tsx` ã‚’é–‹ã
3. ä¸­èº«ã‚’ã„ã£ãŸã‚“å…¨éƒ¨æ¶ˆã—ã¦ã€æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒšã—ã¦ã¿ã¦ãã ã•ã„ ğŸ‘‡

```tsx
import { useEffect, useState } from "react";

function App() {
  const [count, setCount] = useState(0);

  // ğŸ‘‡ ã“ã“ãŒã“ã®ç« ã®ä¸»å½¹ï¼
  useEffect(() => {
    console.log("ğŸ‰ count ãŒå¤‰ã‚ã‚Šã¾ã—ãŸï¼ä»Šã®å€¤ã¯:", count);
  }, [count]); // â† ã€Œcount ã‚’è¦‹å¼µã‚‹ã€ãƒªã‚¹ãƒˆ

  const handleClick = () => {
    setCount(count + 1);
  };

  return (
    <div style={{ padding: "24px", fontFamily: "sans-serif" }}>
      <h1>ç¬¬60ç« ï¼šuseEffect ã®è¦‹å¼µã‚Šãƒªã‚¹ãƒˆ [count] ğŸ‘€</h1>

      <p>count: {count}</p>

      <button onClick={handleClick}>
        ï¼‹1ã™ã‚‹ãƒœã‚¿ãƒ³ âœ¨
      </button>

      <p style={{ marginTop: "16px" }}>
        ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ï¼ˆF12ï¼‰ã‚’é–‹ã„ã¦ã€Consoleã‚¿ãƒ–ã‚’è¦‹ã¦ã¿ã¦ã­ ğŸ‘‡
      </p>
    </div>
  );
}

export default App;
```

#### â–¶ å‹•ã‹ã—ã¦ã¿ã‚ˆã†

1. ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§

   ```bash
   npm run dev
   ```

2. ãƒ–ãƒ©ã‚¦ã‚¶ã§è¡¨ç¤ºã—ã¦ã„ã‚‹ç”»é¢ã§ã€`F12` ã¾ãŸã¯ `Ctrl + Shift + I` ã‚’æŠ¼ã—ã¦
   **Console ã‚¿ãƒ–** ã‚’é–‹ã

3. ã€Œï¼‹1ã™ã‚‹ãƒœã‚¿ãƒ³ âœ¨ã€ã‚’ãƒãƒãƒãƒã™ã‚‹

ğŸ’¡ ã™ã‚‹ã¨â€¦

* ãƒšãƒ¼ã‚¸ã‚’é–‹ã„ãŸç¬é–“ï¼š
  `count` ã®åˆæœŸå€¤ã¯ `0` ãªã®ã§ã€**1å›ãƒ­ã‚°ãŒå‡ºã‚‹**
* ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ `count` ãŒ `1`, `2`, `3`â€¦ ã¨å¤‰ã‚ã‚‹ãŸã³ã«
  ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«

  > ğŸ‰ count ãŒå¤‰ã‚ã‚Šã¾ã—ãŸï¼ä»Šã®å€¤ã¯: 1
  > ğŸ‰ count ãŒå¤‰ã‚ã‚Šã¾ã—ãŸï¼ä»Šã®å€¤ã¯: 2

  â€¦ã¨ã„ã†ãƒ­ã‚°ãŒå‡ºã‚‹ã¯ãšã§ã™ âœ…

é€†ã«ã€`count` ã‚’å¤‰ãˆãªã„é™ã‚Šã€`useEffect` ã¯å®Ÿè¡Œã•ã‚Œã¾ã›ã‚“ã€‚
ã“ã‚ŒãŒ **è¦‹å¼µã‚Šãƒªã‚¹ãƒˆ `[count]` ã®åŠ¹æœ** ã§ã™ ğŸŒŸ

---

### 5ï¸âƒ£ å®Ÿé¨“â‘¡ï¼šä»–ã® state ãŒå¤‰ã‚ã£ã¦ã‚‚å‹•ã‹ãªã„ã®ï¼ŸğŸ¤”

`[count]` ã ã‘ã‚’è¦‹å¼µã£ã¦ã„ã‚‹ã®ã§ã€ã€Œåˆ¥ã® stateã€ãŒå¤‰ã‚ã£ã¦ã‚‚ `useEffect` ã¯å‹•ãã¾ã›ã‚“ã€‚
ä¸€ç·’ã«ç¢ºã‹ã‚ã¦ã¿ã¾ã—ã‚‡ã† ğŸ’ª

ã•ã£ãã® `App.tsx` ã‚’ã€ã“ã‚“ãªæ„Ÿã˜ã§å°‘ã—æ›¸ãæ›ãˆã¦ã¿ã¾ã™ ğŸ‘‡

```tsx
import { useEffect, useState } from "react";

function App() {
  const [count, setCount] = useState(0);
  const [name, setName] = useState("");

  useEffect(() => {
    console.log("âœ… count ãŒå¤‰ã‚ã£ãŸã‚ˆï¼ä»Šã®å€¤ã¯:", count);
  }, [count]); // â† è¦‹å¼µã£ã¦ã„ã‚‹ã®ã¯ count ã ã‘ï¼

  const handleCountClick = () => {
    setCount(count + 1);
  };

  const handleNameChange = (event: React.ChangeEvent<HTMLInputElement>) => {
    setName(event.target.value);
  };

  return (
    <div style={{ padding: "24px", fontFamily: "sans-serif" }}>
      <h1>useEffect ã®è¦‹å¼µã‚Šãƒªã‚¹ãƒˆ [count] å®Ÿé¨“ ğŸ”</h1>

      <section>
        <h2>â‘  count ãƒœã‚¿ãƒ³</h2>
        <p>count: {count}</p>
        <button onClick={handleCountClick}>count ã‚’ ï¼‹1 ğŸ§®</button>
      </section>

      <section style={{ marginTop: "24px" }}>
        <h2>â‘¡ åå‰å…¥åŠ›</h2>
        <input
          type="text"
          value={name}
          onChange={handleNameChange}
          placeholder="åå‰ã‚’å…¥åŠ›ã—ã¦ã¿ã¦ã­ âœï¸"
        />
        <p>ã“ã‚“ã«ã¡ã¯ã€{name || "ï¼Ÿï¼Ÿï¼Ÿ"} ã•ã‚“ ğŸ‘‹</p>
      </section>
    </div>
  );
}

export default App;
```

#### âœ… ç¢ºèªãƒã‚¤ãƒ³ãƒˆ

* `count` ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã¨ã
  â†’ **ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ­ã‚°ãŒå‡ºã‚‹**ï¼ˆ`count` ãŒå¤‰ã‚ã‚‹ã‹ã‚‰ï¼‰
* `name` ã®å…¥åŠ›æ¬„ã«æ–‡å­—ã‚’æ‰“ã£ãŸã¨ã
  â†’ ç”»é¢ã®è¡¨ç¤ºï¼ˆã€Œã“ã‚“ã«ã¡ã¯ã€ã€‡ã€‡ã•ã‚“ã€ï¼‰ã¯å¤‰ã‚ã‚‹ã‘ã©
  â†’ **ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®ãƒ­ã‚°ã¯å‡ºãªã„**ï¼ˆ`name` ã¯è¦‹å¼µã‚Šãƒªã‚¹ãƒˆã«å…¥ã£ã¦ã„ãªã„ã‹ã‚‰ï¼‰

â†’ ã¤ã¾ã‚Šã€**`[count]` ã¨æ›¸ã„ãŸã¨ãã¯ã€`count` ãŒå¤‰ã‚ã£ãŸã¨ãã ã‘ `useEffect` ãŒå‹•ã**ã€ã¨ã„ã†ã“ã¨ãŒä½“æ„Ÿã§ãã‚‹ã¯ãšã§ã™ ğŸŒˆ

---

### 6ï¸âƒ£ è¦‹å¼µã‚Šãƒªã‚¹ãƒˆã«å…¥ã‚Œã‚‹å€¤ã®ãƒ«ãƒ¼ãƒ«ï¼†æ³¨æ„ç‚¹ âš ï¸

#### ğŸ”¹ åŸºæœ¬ãƒ«ãƒ¼ãƒ«

* `useEffect` ã®ä¸­ã§ä½¿ã£ã¦ã„ã‚‹ã€Œå¤‰ã‚ã‚Šã†ã‚‹å€¤ã€ã¯ã€**è¦‹å¼µã‚Šãƒªã‚¹ãƒˆã«å…¥ã‚Œã‚‹**ã®ãŒåŸºæœ¬ãƒ«ãƒ¼ãƒ«ã§ã™ã€‚

  * ä¾‹ï¼š`props`ã€`state`ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§å®šç¾©ã—ãŸé–¢æ•°ãªã©([react.dev][1])
* ã“ã†ã—ã¦ãŠãã¨ã€**ãã®å€¤ãŒå¤‰ã‚ã‚‹ãŸã³ã«ã¡ã‚ƒã‚“ã¨åŒæœŸã—ã¦ãã‚Œã‚‹**ã®ã§ã€ãƒã‚°ãŒæ¸›ã‚Šã¾ã™ ğŸª„

#### ğŸ”¹ ã‚ˆãã‚ã‚‹å±é™ºãƒ‘ã‚¿ãƒ¼ãƒ³ï¼šç„¡é™ãƒ«ãƒ¼ãƒ— ğŸ˜±

ã“ã‚“ãªæ›¸ãæ–¹ã¯è¦æ³¨æ„ã§ã™ï¼š

```tsx
useEffect(() => {
  setCount(count + 1); // â† ã“ã“ã§ count ã‚’æ›´æ–°
}, [count]); // â† ãã—ã¦ count ã‚’è¦‹å¼µã£ã¦ã„ã‚‹
```

* `count` ãŒå¤‰ã‚ã‚‹
  â†’ `useEffect` ãŒå‹•ã
  â†’ ä¸­ã§ `setCount` ã™ã‚‹
  â†’ ã¾ãŸ `count` ãŒå¤‰ã‚ã‚‹
  â†’ ã•ã‚‰ã« `useEffect` ãŒå‹•ãâ€¦

ã¨ã„ã† **ç„¡é™ãƒ«ãƒ¼ãƒ—** ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ ğŸŒ€

ã“ã†ã„ã†å ´åˆã¯ã€

* æ¡ä»¶ä»˜ãã«ã™ã‚‹ï¼ˆä¾‹ï¼š`if (count < 5) { ... }`ï¼‰
* ãã‚‚ãã‚‚ `setCount` ã¯ãƒœã‚¿ãƒ³ã® `onClick` ã®ä¸­ã ã‘ã§ã‚„ã‚‹

ãªã©ã€**ã€Œæœ¬å½“ã« `useEffect` ã®ä¸­ã§ state ã‚’å¤‰ãˆã‚‹å¿…è¦ãŒã‚ã‚‹ï¼Ÿã€** ã‚’è€ƒãˆã¦ã¿ã‚‹ã¨å®‰å…¨ã§ã™ ğŸ’¡

---

### 7ï¸âƒ£ ã¾ã¨ã‚ï¼š`[state]` ã‚’ã¡ã‚ƒã‚“ã¨ä½¿ãˆã‚‹ã¨è¶…ä¾¿åˆ© ğŸ’

ã“ã®ç« ã§è¦šãˆã¦ãŠããŸã„ãƒã‚¤ãƒ³ãƒˆã¯ã“ã‚Œã ã‘ ğŸŒŸ

* `useEffect` ã®ç¬¬2å¼•æ•°ã¯ã€Œè¦‹å¼µã‚Šãƒªã‚¹ãƒˆï¼ˆä¾å­˜é…åˆ—ï¼‰ã€ğŸ‘€
* `[state]` ã¨æ›¸ãã¨
  â†’ **ãã® `state` ãŒå¤‰ã‚ã£ãŸã¨ãã ã‘** `useEffect` ãŒå®Ÿè¡Œã•ã‚Œã‚‹
* åˆ¥ã® state ãŒå¤‰ã‚ã£ã¦ã‚‚ã€è¦‹å¼µã‚Šãƒªã‚¹ãƒˆã«å…¥ã£ã¦ã„ãªã‘ã‚Œã° `useEffect` ã¯å‹•ã‹ãªã„
* åŒã˜ state ã‚’è¦‹å¼µã‚ŠãªãŒã‚‰ã€ãã®ä¸­ã§ç„¡æ¡ä»¶ã« `setState` ã™ã‚‹ã¨ç„¡é™ãƒ«ãƒ¼ãƒ—ã«ãªã‚‹ã®ã§æ³¨æ„ ğŸŒ€

---

### ğŸ“ ãƒŸãƒ‹ç·´ç¿’ï¼ˆå®¿é¡Œï¼‰ğŸ’Œ

æ™‚é–“ãŒã‚ã‚Œã°ã€ã“ã‚“ãªç·´ç¿’ã‚‚ã—ã¦ã¿ã¦ã­ âœ¨

1. `keyword` ã¨ã„ã†æ–‡å­—åˆ—ã® state ã‚’ä½œã£ã¦ã€
   å…¥åŠ›ãŒå¤‰ã‚ã‚‹ãŸã³ã« `useEffect` ã§
   `console.log("æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰:", keyword)` ã‚’å‡ºã—ã¦ã¿ã‚‹ï¼ˆè¦‹å¼µã‚Šãƒªã‚¹ãƒˆã¯ `[keyword]`ï¼‰
2. `count` ãŒå¤‰ã‚ã£ãŸã¨ãã ã‘ `document.title` ã‚’
   `"count: ã€‡ã€‡"` ã«å¤‰ãˆã‚‹ `useEffect` ã‚’æ›¸ã„ã¦ã¿ã‚‹ï¼ˆè¦‹å¼µã‚Šãƒªã‚¹ãƒˆã¯ã‚‚ã¡ã‚ã‚“ `[count]`ï¼‰

æ¬¡ã®ç« ã‹ã‚‰ã¯ã€

* `[]`
* `[state]`
* ä¾å­˜é…åˆ—ãªã—

ã®ä½¿ã„åˆ†ã‘ã‚’ã€ã•ã‚‰ã«å®Ÿæˆ¦çš„ã«æ·±æ˜ã‚Šã—ã¦ã„ãã¾ã™ ğŸ§ªâœ¨

ãŠã¤ã‹ã‚Œã•ã¾ã€œï¼ã¾ãŸæ¬¡ã®ç« ã§ä¼šãŠã†ã­ ğŸ¥ğŸ’»ğŸ’–

[1]: https://react.dev/reference/react/useEffect?utm_source=chatgpt.com "useEffect"
